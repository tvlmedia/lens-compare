<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <title>↗</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="referrer" content="no-referrer" />
  <style>
    /* standaard onzichtbaar, zodat er niets flitst */
    html,body{height:100%;margin:0;background:#000}
    body{visibility:hidden}
    #fb{display:none;max-width:560px;margin:15vh auto;padding:18px;color:#fff;
        background:#111;border-radius:10px;font:14px/1.5 system-ui,Segoe UI,Inter,sans-serif}
    #fb button{background:#1a1a1a;border:1px solid #444;border-radius:8px;padding:8px 12px;color:#fff;cursor:pointer}
    #fb a{color:#fff}
  </style>
</head>
<body>
  <div id="fb">
    Pop‑up geblokkeerd? <button id="openBtn">Open link</button> of
    <a id="direct" href="#" target="_blank" rel="noopener">klik hier</a>.
  </div>

  <script>
    (function () {
      const p = new URLSearchParams(location.search);
      const raw = p.get("to") || "";
      let url = "";
      try {
        const u = new URL(raw, location.origin);
        if (/^https?:$/i.test(u.protocol)) url = u.href;
      } catch {}

      if (!url) return showFallback();

      // 1) probeer direct te openen
      const w = window.open(url, "_blank", "noopener");

      if (w) {
        try { w.opener = null; } catch {}
        // 2) sluit jezelf ZO SNEL MOGELIJK
        // micro‑delay om popup‑blockers minder te triggeren
        setTimeout(function () {
          window.close();                     // meeste browsers
          // fallback als close niet mag:
          if (!document.hidden) location.replace("about:blank");
        }, 0);

        // extra: zodra dit tabblad niet meer zichtbaar is, nogmaals proberen te sluiten
        document.addEventListener("visibilitychange", function onVC() {
          if (document.visibilityState === "hidden") {
            document.removeEventListener("visibilitychange", onVC);
            try { window.close(); } catch {}
          }
        }, { once: true });

      } else {
        // popup geblokkeerd → toon nette fallback
        showFallback();
      }

      function showFallback() {
        const fb = document.getElementById("fb");
        document.body.style.visibility = "visible";
        fb.style.display = "block";
        const a = document.getElementById("direct");
        const btn = document.getElementById("openBtn");
        a.href = url || "#";
        btn.onclick = () => { window.open(url, "_blank", "noopener"); };
      }
    })();
  </script>

  <noscript>
    <div id="fb" style="display:block;visibility:visible">
      JavaScript staat uit. <a id="direct" href="#" target="_blank" rel="noopener">Open de link</a>.
    </div>
  </noscript>
</body>
</html>
